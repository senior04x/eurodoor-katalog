import{s as d,u as N,j as e}from"./index-D6yUU31p.js";import{r as l}from"./vendor-bd6wVIFv.js";import{m as a,C as w,h as v,B as u,H as S,a as O}from"./ui-CwFwatdP.js";import"./supabase-ByzS6PGn.js";const x={async testOrderStatusChange(s,r){try{console.log(`üß™ Testing notification for order: ${s}, status: ${r}`);const{error:o}=await d.from("orders").update({status:r,updated_at:new Date().toISOString()}).eq("order_number",s);return o?(console.error("‚ùå Failed to update order status:",o),{success:!1,error:o.message}):(console.log("‚úÖ Order status updated successfully"),{success:!0,message:"Order status updated"})}catch(o){return console.error("‚ùå Test notification error:",o),{success:!1,error:"Test failed"}}},async checkOrderExists(s){try{const{data:r,error:o}=await d.from("orders").select("*").eq("order_number",s).single();return o?(console.error("‚ùå Order not found:",o),{success:!1,error:"Order not found"}):(console.log("‚úÖ Order found:",r),{success:!0,data:r})}catch(r){return console.error("‚ùå Check order error:",r),{success:!1,error:"Check failed"}}},async getAllOrders(){try{const{data:s,error:r}=await d.from("orders").select("*").order("created_at",{ascending:!1}).limit(10);return r?(console.error("‚ùå Failed to get orders:",r),{success:!1,error:r.message}):(console.log("‚úÖ Orders retrieved:",s),{success:!0,data:s})}catch(s){return console.error("‚ùå Get orders error:",s),{success:!1,error:"Get orders failed"}}}};typeof window<"u"&&(window.testNotificationSystem=x);const D=({orderNumber:s,customerName:r,customerPhone:o,totalAmount:h,onNavigate:m})=>{const{t}=N(),[n,f]=l.useState({orderNumber:s||"",customerName:r||"",customerPhone:o||"",totalAmount:h||0});l.useEffect(()=>{const i=localStorage.getItem("lastOrderData");if(i){const j=JSON.parse(i);f(j)}},[]);const[c]=l.useState("checking");l.useEffect(()=>{},[]);const b=async()=>{},y=async()=>{try{if(c!=="granted"){console.log("‚ùå Notification permission not granted");return}const i=await x.testOrderStatusChange(n.orderNumber,"confirmed");i.success?console.log("‚úÖ Test order status change successful"):console.error("‚ùå Test order status change failed:",i.error),console.log("‚úÖ Test notification sent")}catch(i){console.error("Error sending test notification:",i)}},p=()=>{localStorage.removeItem("lastOrderData"),m("home")},g=()=>{localStorage.removeItem("lastOrderData"),m("catalog")};return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 overflow-auto",children:e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 pt-28",children:e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-2xl w-full",children:[e.jsxs(a.div,{initial:{scale:.9},animate:{scale:1},transition:{delay:.2,duration:.5},className:"bg-white/10 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 p-8 text-center",children:[e.jsx(a.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"w-12 h-12 text-green-600"})})}),e.jsx(a.h1,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"text-3xl font-bold text-white mb-4",children:t("orderSuccess.title")}),e.jsx(a.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-gray-200 text-lg mb-8",children:t("orderSuccess.subtitle")}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"bg-white/5 backdrop-blur-sm rounded-2xl p-6 mb-8 text-left border border-white/10",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4 text-center",children:t("orderSuccess.orderDetails")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/20",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:t("orderSuccess.orderNumber")}),e.jsx("span",{className:"text-white font-bold text-lg",children:n.orderNumber})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/20",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:t("orderSuccess.customerName")}),e.jsx("span",{className:"text-white font-semibold",children:n.customerName})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/20",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:t("orderSuccess.phone")}),e.jsx("span",{className:"text-white font-semibold",children:n.customerPhone})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:t("orderSuccess.totalAmount")}),e.jsxs("span",{className:"text-green-400 font-bold text-xl",children:[n.totalAmount.toLocaleString()," so'm"]})]})]})]}),e.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.9},className:"bg-blue-500/10 backdrop-blur-sm rounded-2xl p-6 mb-8 border border-blue-400/20",children:[e.jsxs("div",{className:"flex items-center justify-center mb-3",children:[e.jsx(v,{className:"w-5 h-5 text-blue-400 mr-2"}),e.jsx("h4",{className:"text-lg font-semibold text-blue-300",children:t("orderSuccess.contactInfo")})]}),e.jsx("p",{className:"text-blue-200 text-center",children:t("orderSuccess.contactText")})]}),c!=="granted"&&e.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.95},className:"bg-yellow-500/10 backdrop-blur-sm rounded-2xl p-6 mb-8 border border-yellow-400/20",children:[e.jsxs("div",{className:"flex items-center justify-center mb-3",children:[e.jsx(u,{className:"w-5 h-5 text-yellow-400 mr-2"}),e.jsx("h4",{className:"text-lg font-semibold text-yellow-300",children:t("orderSuccess.notificationTitle")})]}),e.jsx("p",{className:"text-yellow-200 text-center mb-4",children:t("orderSuccess.notificationText")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:b,className:"flex-1 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-200 font-semibold py-3 px-6 rounded-xl border border-yellow-400/30 transition-all duration-300 hover:scale-105",children:t("orderSuccess.enableNotifications")}),e.jsx("button",{onClick:y,className:"bg-blue-500/20 hover:bg-blue-500/30 text-blue-200 font-semibold py-3 px-4 rounded-xl border border-blue-400/30 transition-all duration-300 hover:scale-105",title:"Test notification",children:"üß™"})]})]}),c==="granted"&&e.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.95},className:"bg-green-500/10 backdrop-blur-sm rounded-2xl p-6 mb-8 border border-green-400/20",children:[e.jsxs("div",{className:"flex items-center justify-center mb-3",children:[e.jsx(u,{className:"w-5 h-5 text-green-400 mr-2"}),e.jsx("h4",{className:"text-lg font-semibold text-green-300",children:t("orderSuccess.notificationsEnabled")})]}),e.jsx("p",{className:"text-green-200 text-center",children:t("orderSuccess.notificationsEnabledText")})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs("button",{onClick:p,className:"flex items-center justify-center px-8 py-4 bg-white/10 backdrop-blur-sm border border-white/20 text-white rounded-2xl font-semibold hover:bg-white/20 hover:border-white/30 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 hover:scale-105",children:[e.jsx(S,{className:"w-5 h-5 mr-2"}),t("orderSuccess.goHome")]}),e.jsxs("button",{onClick:g,className:"flex items-center justify-center px-8 py-4 bg-gradient-to-r from-emerald-500/20 to-green-500/20 backdrop-blur-sm border border-emerald-400/30 text-emerald-300 rounded-2xl font-semibold hover:from-emerald-500/30 hover:to-green-500/30 hover:border-emerald-400/50 hover:text-emerald-200 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 hover:scale-105",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),t("orderSuccess.newOrder")]})]})]}),e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.1},className:"mt-8 text-center",children:e.jsx("p",{className:"text-gray-300 text-sm",children:t("orderSuccess.thankYou")})})]})})})};export{D as default};
