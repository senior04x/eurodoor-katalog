const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/home-DxAThpki.js","assets/react-vendor-OC9BnM2e.js","assets/vendor-DWqYTkxU.js","assets/catalog-B9v9_i5l.js","assets/components-SIUihzca.js","assets/animations-l-4DVOGa.js","assets/lib-nofVMXM3.js","assets/supabase-Ju67T4xf.js","assets/product-CQ1es9p1.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,y as s,z as o}from"./react-vendor-OC9BnM2e.js";import{_ as a}from"./supabase-Ju67T4xf.js";import{i as n,A as r,E as i,a as c,H as l,F as d,b as u,N as m}from"./components-SIUihzca.js";import{L as h,C as p,T as j}from"./catalog-B9v9_i5l.js";import{A as f,m as x}from"./animations-l-4DVOGa.js";import{s as _}from"./lib-nofVMXM3.js";import"./vendor-DWqYTkxU.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const g=e.lazy(()=>a(()=>import("./home-DxAThpki.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),y=e.lazy(()=>a(()=>import("./catalog-B9v9_i5l.js").then(e=>e.c),__vite__mapDeps([3,1,2,4,5,6,7]))),v=e.lazy(()=>a(()=>import("./components-SIUihzca.js").then(e=>e.c),__vite__mapDeps([4,1,2,5,3,6,7]))),w=e.lazy(()=>a(()=>import("./components-SIUihzca.js").then(e=>e.C),__vite__mapDeps([4,1,2,5,3,6,7]))),b=e.lazy(()=>a(()=>import("./product-CQ1es9p1.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]))),E=e.lazy(()=>a(()=>import("./components-SIUihzca.js").then(e=>e.O),__vite__mapDeps([4,1,2,5,3,6,7]))),L=e.lazy(()=>a(()=>import("./components-SIUihzca.js").then(e=>e.d),__vite__mapDeps([4,1,2,5,3,6,7]))),N=e.lazy(()=>a(()=>import("./components-SIUihzca.js").then(e=>e.P),__vite__mapDeps([4,1,2,5,3,6,7]))),S=e.lazy(()=>a(()=>import("./components-SIUihzca.js").then(e=>e.e),__vite__mapDeps([4,1,2,5,3,6,7])));function T(){const s=()=>{const e=window.location.hash.replace("#","");if(e.startsWith("product-detail/"))return"product-detail";return["home","catalog","about","contact","orders","profile","order-success","product-detail"].includes(e)?e:"home"},o=()=>{const e=window.location.hash.replace("#","");return e.startsWith("product-detail/")?e.split("/")[1]:null},[_,T]=e.useState(s()),[A,P]=e.useState(null),[I,O]=e.useState(!0),[k,D]=e.useState(!1),[R,V]=e.useState("login"),[z,C]=e.useState(!1);e.useEffect(()=>{const e=window.Telegram?.WebApp||window.location.href.includes("t.me")||window.location.href.includes("telegram.me")||navigator.userAgent.includes("TelegramBot");C(!!e),a(()=>import("./home-DxAThpki.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),a(()=>import("./catalog-B9v9_i5l.js").then(e=>e.c),__vite__mapDeps([3,1,2,4,5,6,7]));const t=e=>{"NAVIGATE_TO_ORDERS"===e.data?.type&&W("orders")};navigator.serviceWorker?.addEventListener("message",t);const r=setTimeout(()=>{O(!1)},800);document.body.style.overflow="auto",document.body.classList.remove("overflow-hidden");const i=()=>{const e=s(),t=o();T(e),P("product-detail"===e&&t?{id:t}:null)};return window.addEventListener("hashchange",i),n(),()=>{clearTimeout(r),window.removeEventListener("hashchange",i),navigator.serviceWorker?.removeEventListener("message",t),document.body.style.overflow="auto",document.body.classList.remove("overflow-hidden")}},[]),e.useEffect(()=>{const e=window.location.hash.replace("#","");if(e.startsWith("product-detail/")){const t=e.split("/")[1];P({id:t})}else P(null)},[]),e.useEffect(()=>{document.body.style.overflow="auto",document.body.classList.remove("overflow-hidden"),window.scrollTo({top:0,behavior:"smooth"})},[_]);const W=e.useCallback((e,t)=>{"product-detail"===e&&t?(P({id:t}),T("product-detail"),window.location.hash=`product-detail/${t}`):(T(e),P(null),window.location.hash=e,"catalog"===e&&setTimeout(()=>{T("catalog")},50))},[_,A]);return I?t.jsx(r,{isLoading:!0}):t.jsx(i,{children:t.jsx(h,{children:t.jsx(c,{children:t.jsx(p,{children:t.jsx(j,{children:t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 overflow-hidden",children:[t.jsx(l,{onNavigate:W}),t.jsx(d,{currentPage:_,onNavigate:W,onShowAuthModal:e=>{V(e),D(!0)}}),t.jsx(f,{mode:"wait",children:t.jsx(x.main,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"relative "+(z?"pt-24":""),style:z?{paddingTop:"calc(env(safe-area-inset-top, 0px) + 80px)"}:{},children:(()=>{const s=e.memo(()=>t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx(r,{isLoading:!0})}));switch(_){case"home":default:return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(g,{onNavigate:W})});case"catalog":return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(y,{onNavigate:W})});case"about":return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(v,{onNavigate:W})});case"contact":return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(w,{onNavigate:W})});case"product-detail":{const a=A?.id||o();return a?t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(b,{productId:a,onNavigate:W})}):t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Mahsulot topilmadi"}),t.jsxs("p",{className:"text-gray-300 mb-4",children:["Product ID: ",a||"undefined"]}),t.jsx("button",{onClick:()=>W("catalog"),className:"bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600",children:"Katalogga qaytish"})]})})}case"order-success":return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(E,{onNavigate:W})});case"orders":return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(L,{})});case"profile":return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(N,{onNavigate:W})});case"notifications":return t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(S,{})});case"admin":return window.open("http://localhost:3001","_blank"),t.jsx(e.Suspense,{fallback:t.jsx(s,{}),children:t.jsx(g,{onNavigate:W})})}})()},_)}),t.jsx(u,{isOpen:k,onClose:()=>D(!1),mode:R,onModeChange:V}),t.jsx(m,{})]})})})})})})}let A=!1;_.auth.onAuthStateChange(async(e,t)=>{if("SIGNED_IN"===e&&t?.user)try{await function(e,t=6e3){return Promise.race([Promise.resolve(e),new Promise((e,s)=>setTimeout(()=>s(new Error("timeout")),t))])}(_.from("customers").select("id").eq("user_id",t.user.id).maybeSingle(),6e3)}catch(s){}finally{A||(A=!0,location.hash="orders")}}),s(document.getElementById("root")).render(t.jsx(o.StrictMode,{children:t.jsx(T,{})}));
