import{u as j,a as f,b as N,j as e,s as w}from"./index-D6yUU31p.js";import{r as l}from"./vendor-bd6wVIFv.js";import{p as v}from"./productsApi-CKc7C4fK.js";import{d as y,w as k,q,S as b,M as P,P as z,R as S,p as D}from"./ui-CwFwatdP.js";import"./supabase-ByzS6PGn.js";function Q({productId:t,onNavigate:i}){j();const{addToCart:u}=f(),{showSuccess:o}=N();console.log("🎯 ProductDetailPage rendered with productId:",t),console.log("🎯 ProductDetailPage props:",{productId:t,onNavigate:!!i});const[s,c]=l.useState(null),[n,d]=l.useState(!0),[a,h]=l.useState(1);l.useEffect(()=>{const m=async()=>{try{console.log("🔄 Loading product with ID:",t),console.log("🔄 ProductId type:",typeof t),console.log("🔄 ProductId length:",t?.length),d(!0),console.log("🔄 Making direct Supabase call...");const{data:r,error:p}=await w.from("products").select("*").eq("id",t).eq("is_active",!0).single();console.log("📦 Direct Supabase response:",{data:r,error:p});const x=await v.getProductById(t);console.log("📦 API fetched product:",x),x?(c(x),console.log("✅ Product loaded successfully")):(console.error("❌ Product not found or inactive"),c(null))}catch(r){console.error("❌ Error loading product:",r),c(null)}finally{d(!1)}};t?(console.log("🎯 ProductId exists, loading product..."),m()):(console.log("❌ No productId provided"),d(!1))},[t]);const g=()=>{if(!s)return;if(s.stock<=0){o("Xatolik!","Bu mahsulot omborda yo'q");return}if(a>s.stock){o("Xatolik!",`Omborda faqat ${s.stock} dona mavjud`);return}const m={id:s.id,name:s.name,price:s.price,image:s.image||s.image_url||"",dimensions:s.dimensions,material:s.material,stock:s.stock};for(let r=0;r<a;r++)u(m);o("Mahsulot qo'shildi!",`${a} ta ${s.name} korzinkaga qo'shildi`)};return n?e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx("div",{className:"fixed inset-0 bg-cover bg-center",style:{backgroundImage:"url('https://iili.io/KqAQo3g.jpg')"}}),e.jsx("div",{className:"fixed inset-0 bg-black/30"}),e.jsx("div",{className:"relative z-10 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Mahsulot yuklanmoqda..."}),e.jsxs("p",{className:"text-white/60 text-sm mt-2",children:["Product ID: ",t]}),e.jsxs("p",{className:"text-white/60 text-sm",children:["Loading state: ",n?"true":"false"]})]})})]}):s?e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx("div",{className:"fixed inset-0 bg-cover bg-center",style:{backgroundImage:"url('https://iili.io/KqAQo3g.jpg')"}}),e.jsx("div",{className:"fixed inset-0 bg-black/30"}),e.jsx("div",{className:"relative z-10 p-4",children:e.jsxs("button",{onClick:()=>i("catalog"),className:"flex items-center gap-2 text-white hover:text-gray-300 transition-all duration-300 bg-white/10 backdrop-blur-xl px-4 py-2 rounded-xl border border-white/20 hover:border-blue-500/50 hover:bg-white/20",children:[e.jsx(k,{className:"h-5 w-5"}),"Katalogga qaytish"]})}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-4 bg-gradient-to-r from-white via-blue-100 to-purple-100 bg-clip-text text-transparent",children:s.name})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"aspect-square rounded-3xl overflow-hidden bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-xl border border-white/20 shadow-2xl hover:border-blue-500/50 transition-all duration-300",children:e.jsx("img",{src:s.image||s.image_url||"https://picsum.photos/600/600?random=1",alt:s.name,className:"w-full h-full object-cover transition-transform duration-300 hover:scale-105"})})}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 backdrop-blur-sm rounded-2xl p-6 border border-green-500/30 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"bg-green-500/30 border border-green-500/50 rounded-full p-2",children:e.jsx(q,{className:"h-5 w-5 text-green-300"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Narx"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("p",{className:"text-3xl font-bold text-green-300",children:[s.price.toLocaleString()," ",s.currency]}),e.jsx("p",{className:"text-gray-300 text-sm",children:s.currency==="USD"?"Dollar":"Sum"})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Batafsil ma'lumot uchun biz bilan bog'laning"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-xl rounded-3xl p-6 border border-white/20 shadow-xl hover:border-blue-500/50 transition-all duration-300",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),"Korzinkaga qo'shish"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-300 font-medium mb-2",children:"Miqdor"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>h(Math.max(1,a-1)),className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-colors",children:e.jsx(P,{className:"h-4 w-4 text-white"})}),e.jsx("span",{className:"w-16 text-center text-white font-semibold",children:a}),e.jsx("button",{onClick:()=>h(Math.min(s?.stock||1,a+1)),disabled:a>=(s?.stock||0),className:`w-10 h-10 rounded-lg flex items-center justify-center transition-colors ${a>=(s?.stock||0)?"bg-gray-500/20 cursor-not-allowed opacity-50":"bg-white/20 hover:bg-white/30"}`,children:e.jsx(z,{className:"h-4 w-4 text-white"})})]})]}),e.jsxs("button",{onClick:g,disabled:!s||s.stock<=0,className:`w-full py-3 px-6 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2 shadow-lg ${!s||s.stock<=0?"bg-gray-500/20 text-gray-400 cursor-not-allowed border border-gray-500/50":"bg-gradient-to-r from-blue-500/30 to-purple-500/30 text-blue-300 hover:from-blue-500/40 hover:to-purple-500/40 border border-blue-500/50 hover:shadow-xl transform hover:scale-105"}`,children:[e.jsx(b,{className:"h-5 w-5"}),!s||s.stock<=0?"Omborda yo'q":"Korzinkaga qo'shish"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-xl rounded-3xl p-6 border border-white/20 shadow-xl hover:border-blue-500/50 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-blue-500/30 border border-blue-500/50 rounded-full p-2",children:e.jsx(S,{className:"h-5 w-5 text-blue-300"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Texnik xususiyatlar"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/10",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"Material:"}),e.jsx("span",{className:"text-white font-semibold",children:s.material})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/10",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"Xavfsizlik:"}),e.jsx("span",{className:"text-white font-semibold",children:s.security})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/10",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"O'lcham:"}),e.jsx("span",{className:"text-white font-semibold",children:s.dimensions})]}),s.thickness&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/10",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"Qalinlik:"}),e.jsxs("span",{className:"text-white font-semibold",children:[s.thickness,"mm"]})]}),s.lock_stages&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-white/10",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"Qulf:"}),e.jsx("span",{className:"text-white font-semibold",children:s.lock_stages})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"Omborda:"}),e.jsxs("span",{className:`font-semibold ${s.stock>0?"text-green-400":"text-red-400"}`,children:[s.stock," dona"]})]})]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-purple-500/30 border border-purple-500/50 rounded-full p-2",children:e.jsx(D,{className:"h-5 w-5 text-purple-300"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Xususiyatlar"})]}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300",children:"Galvanizlangan korpus"})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300",children:"Issiqlik va tovush izolyatsiyasi"})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300",children:"UV chidamli bo'yoq"})]})]})]})]})]}),s.description&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-xl rounded-3xl p-6 border border-white/20 shadow-xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Tavsif"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:s.description})]})})]})})]}):e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx("div",{className:"fixed inset-0 bg-cover bg-center",style:{backgroundImage:"url('https://iili.io/KqAQo3g.jpg')"}}),e.jsx("div",{className:"fixed inset-0 bg-black/30"}),e.jsx("div",{className:"relative z-10 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Mahsulot topilmadi"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Kechirasiz, bu mahsulot mavjud emas"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["Product ID: ",t]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["Loading: ",n?"true":"false"]}),e.jsx("button",{onClick:()=>i("catalog"),className:"bg-blue-500/20 text-blue-300 px-6 py-3 rounded-lg font-semibold hover:bg-blue-500/30 transition-colors",children:"Katalogga qaytish"})]})})]})}export{Q as default};
